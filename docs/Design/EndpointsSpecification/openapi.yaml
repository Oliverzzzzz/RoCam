openapi: 3.0.3
info:
  title: Vision Guided Tracker API
  version: 1.0.0
  description: API for controlling the tracker backend and querying status.
servers:
  - url: http://localhost:5000
    description: Frontend development default
  - url: http://localhost
    description: Flask run default on port 80
paths:
  /api/status:
    post:
      summary: Get current system status
      responses:
        "200":
          description: Current status snapshot.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StatusResponse"
  /api/manual_move:
    post:
      summary: Move the gimbal in a direction
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ManualMoveRequest"
      responses:
        "200":
          description: Command accepted.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmptyResponse"
  /api/manual_move_to:
    post:
      summary: Move the gimbal to absolute angles
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ManualMoveToRequest"
      responses:
        "200":
          description: Command accepted.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmptyResponse"
  /api/arm:
    post:
      summary: Arm tracking
      responses:
        "200":
          description: Command accepted.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmptyResponse"
  /api/disarm:
    post:
      summary: Disarm tracking
      responses:
        "200":
          description: Command accepted.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmptyResponse"
components:
  schemas:
    StatusResponse:
      type: object
      additionalProperties: false
      required:
        - armed
        - tilt
        - pan
        - preview
        - bbox
      properties:
        armed:
          type: boolean
        tilt:
          type: number
          nullable: true
        pan:
          type: number
          nullable: true
        preview:
          type: string
          description: Base64-encoded JPEG frame.
          nullable: true
        bbox:
          $ref: "#/components/schemas/BoundingBox"
    BoundingBox:
      type: object
      additionalProperties: false
      required:
        - pts_s
        - conf
        - left
        - top
        - width
        - height
      properties:
        pts_s:
          type: number
          description: Presentation timestamp in seconds.
        conf:
          type: number
        left:
          type: number
        top:
          type: number
        width:
          type: number
        height:
          type: number
      nullable: true
    ManualMoveRequest:
      type: object
      additionalProperties: false
      required:
        - direction
      properties:
        direction:
          type: string
          enum:
            - up
            - down
            - left
            - right
    ManualMoveToRequest:
      type: object
      additionalProperties: false
      required:
        - tilt
        - pan
      properties:
        tilt:
          type: number
        pan:
          type: number
    EmptyResponse:
      type: object
      additionalProperties: false
